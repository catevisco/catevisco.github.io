<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Slavery</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css">
    
    <style type="text/css">
    

    </style>
</head>
<body>
<div id="info1">

    <h1>SLAVERY TOP 20</h1>
    <h2>Here are the 20 countries with the highest estimated proportion of pupulation in modern slavery around the World? (%)</h2>
    <p>Data from <a href="http://www.globalslaveryindex.org/download/#download-the-data">The Global Slavery Index</a></p>

</div>

    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script>
             var diameter = 600, //max size of the bubbles
                 color    = d3.scale.category20c(); //color category

             var bubble = d3.layout.pack()
                .sort(null)
                .size([diameter, diameter])
                .padding(1);

            var svg = d3.select("body")
                .append("svg")
                .attr("width", 1200)
                .attr("height", diameter)
                .attr("class", "bubble");            


            d3.csv("slavery3.csv", function(error, data){

                console.log(data);

                
                //convert numerical values from strings to numbers
                data = data.map(function(d){ d.value = +d["Corrected"]; return d; });


                //bubbles needs very specific format, convert data to this.
                var nodes = bubble.nodes({children:data}).filter(function(d) { return !d.children; });

                var title = svg
                    .append("text")
                    .style({"font-size":"24px"});

                //setup the chart
                var bubbles = svg.append("g")
                    .attr("transform", "translate(0,0)")
                    .selectAll(".bubble")
                    .data(nodes)
                    .enter();

                //create the bubbles
                bubbles.append("circle")
                    .attr("class", "bubbles")
                    .attr("r", function(d){ return d.r; })
                    .attr("cx", function(d){ return d.x; })
                    .attr("cy", function(d){ return d.y; })
                    .style("fill", function(d) { return color(d.value); });
                    


                //format the text for each bubble
                bubbles.append("text")
                    .attr("class", "names")
                    .attr("x", function(d){ return d.x; })
                    .attr("y", function(d){ return d.y + 5; })
                    .attr("text-anchor", "middle")
                    .text(function(d){ return d["Country"]; })
                    .style({
                        "fill":"black", 
                        "font-family":"Helvetica Neue, Helvetica, Arial, sans-serif",
                        "font-size": "12px"
                    })
                     .on("mouseover", function(d) {

                                        d3.select(this)
                                        .text(function(d){ return d["Info"];})
                                        .style({
                                                    "fill":"black", 
                                                    "font-size": "18px",
                                                    "font-weight":"bold"
                                                });

                    })

                      .on("mouseout", function(d) {

                                        d3.select(this)
                                        .text(function(d){ return d["Country"];})
                                        .style({
                                                    "fill":"black", 
                                                    "font-size": "12px",
                                                    "font-weight":"normal"
                                                });;

                    });


                       


                
            });

    </script>
</body>
</html>